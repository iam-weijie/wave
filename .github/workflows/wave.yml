name: Wave

on:
  schedule:
    - cron: '*/5 * * * *' # Run every 5 minutes
  push:
    branches:
      - main

jobs:
  wave:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout code
        uses: actions/checkout@v2
      - name: Update README
        run: |
          LEFT_WAVE='👋'
          RIGHT_WAVE='👋🏻'
          WAVE_EMOJI=$LEFT_WAVE
          
          LAST_COMMIT_MESSAGE=$(git log -1 --pretty=%B)
          if [[ "$LAST_COMMIT_MESSAGE" == *"Wave with $LEFT_WAVE"* ]]; then
            WAVE_EMOJI=$RIGHT_WAVE
          fi
          
          echo "$WAVE_EMOJI" > README.md
          git add README.md
          git commit -m "Wave with $WAVE_EMOJI"
          git push
